function MusikipediaKlaviatur(e){"use strict";var l,r,t,d,n,c,a="",o,k,u;function i(){var e,t,a,n,o,i,s;for(e=[[{key:"81",note:"1C",color:"white"},{key:"50",note:"1Cs",color:"black"}],[{key:"87",note:"1D",color:"white"},{key:"51",note:"1Ds",color:"black"}],[{key:"69",note:"1E",color:"white"}],[{key:"82",note:"1F",color:"white"},{key:"53",note:"1Fs",color:"black"}],[{key:"84",note:"1G",color:"white"},{key:"54",note:"1Gs",color:"black"}],[{key:"89",note:"2A",color:"white"},{key:"55",note:"2As",color:"black"}],[{key:"85",note:"2B",color:"white"}],[{key:"73",note:"2C",color:"white"},{key:"57",note:"2Cs",color:"black"}],[{key:"79",note:"2D",color:"white"},{key:"48",note:"2Ds",color:"black"}],[{key:"80",note:"2E",color:"white"}],[{key:"219",note:"2F",color:"white"},{key:"187",note:"2Fs",color:"black"}],[{key:"221",note:"2G",color:"white"},{key:"65",note:"2Gs",color:"black"}],[{key:"90",note:"3A",color:"white"},{key:"83",note:"3As",color:"black"}],[{key:"88",note:"3B",color:"white"}]],(r=document.createElement("ul")).classList.add("piano"),s=36,o=0;o<e.length;o++){for((t=document.createElement("li")).classList.add("key"),c&&t.classList.add("skrivning"),i=0;i<e[o].length;i++)(a=document.createElement("span")).classList.add(e[o][i].color+"-key"),a.setAttribute("data-key",e[o][i].key),a.setAttribute("data-note",e[o][i].note),a.setAttribute("afstandIHalvtonerFraC0",s),a.addEventListener("mousedown",h),a.addEventListener("mouseup",g),a.addEventListener("mouseout",g),n=document.createElement("i"),a.appendChild(n),t.appendChild(a),s++;r.appendChild(t)}l.appendChild(r)}function s(){null===t&&((t=document.createElement("p")).classList.add("svarknapper"),(d=document.createElement("button")).setAttribute("id",l.id+"_svarknap"),d.addEventListener("click",function(){null!==o&&o()}),d.className="nodesvarknap",d.innerHTML=a,d.disabled=!0,t.appendChild(d),l.appendChild(t)),MusikipediaOpgave.skrivRespons(),v()}function v(){d&&(d.innerHTML=a,d.className=d.className.replace(/(?:^|\s)rigtigt(?!\S)/g,""),d.className=d.className.replace(/(?:^|\s)forkert(?!\S)/g,""),d.disabled=!1)}function m(){var e,t,a,n,o,i;for(e=0;e<r.childNodes.length;e++)for(a=r.childNodes[e],t=0;t<a.childNodes.length;t++)o=(n=a.childNodes[t]).childNodes[0],null!==(i=u.tonePaaSammeTangent({afstandIHalvtonerFraC0:parseInt(n.getAttribute("afstandIHalvtonerFraC0"),10)}))&&!0===i.laast||(o.className="",u.sletTonerPaaSammeTangent(i))}function h(){var e,t,a;c&&(e=this.childNodes[0],t=new MusikipediaTone({afstandIHalvtonerFraC0:parseInt(this.getAttribute("afstandIHalvtonerFraC0"),10)}),null!==(a=u.tonePaaSammeTangent(t))&&!0===a.laast||(this.classList.add("active"),""!==e.className?(e.className="",u.sletTonerPaaSammeTangent(t)):(n&&m(),e.className="normal",u.toner.push(t)))),MusikipediaOpgave.skrivRespons(),v(),d&&(d.disabled=u.ingenUlaasteToner()&&!k)}function g(){this.className=this.className.replace(/(?:^|\s)active(?!\S)/g,"")}function p(e){var t;t=e.key||e.keyCode,"Enter"!==e.code&&"NumpadEnter"!==e.code&&"Enter"!==t&&"NumpadEnter"!==t||d&&(d.disabled||null!==o&&o())}this.slaaSkrivningTil=function(e){(c=e)?(null===t&&s(),t.style.display="block"):null!==t&&(t.style.display="none")},this.goerSvarknapUtilgaengelig=function(){d&&(d.disabled=!0)},this.blinkForRigtigSvar=function(e){var t;d&&(d.disabled=!0,d.className+=" rigtigt",d.innerHTML="✔︎"),t=setTimeout(function(){v(),void 0!==e&&e()},800)},this.angivForkertSvar=function(){d&&(d.disabled=!0,d.className+=" forkert",d.innerHTML="✘")},this.blinkForForkertSvar=function(e){var t;this.angivForkertSvar(),t=setTimeout(function(){v(),void 0!==e&&e()},800)},this.samklang=function(){return u},this.saetSamklang=function(e){var t,a,n,o,i,s;for(u=new MusikipediaSamklang(e),t=0;t<r.childNodes.length;t++)for(n=r.childNodes[t],a=0;a<n.childNodes.length;a++)i=(o=n.childNodes[a]).childNodes[0],s=u.tonePaaSammeTangent({afstandIHalvtonerFraC0:parseInt(o.getAttribute("afstandIHalvtonerFraC0"),10)}),i.className=null===s?"":s.markering;d&&(d.disabled=u.ingenUlaasteToner()&&!k)},l=e.elementSomKlaviaturetSkalTilfoejes,n=void 0!==e.maxEnTone&&e.maxEnTone,c=void 0!==e.skrivning&&e.skrivning,o=void 0!==e.svarfunktion?e.svarfunktion:null,a=void 0!==e.svarknaptekst?e.svarknaptekst:"?",k=void 0!==e.tilladSvarKunMedLaasteTangenter&&e.tilladSvarKunMedLaasteTangenter,u=new MusikipediaSamklang([]),i(),t=null,this.slaaSkrivningTil(c),document.addEventListener("keydown",p)}